<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freehand | Skills for the Real World</title>
    <link rel="stylesheet" href="style.css?v=6.0">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <div class="brand-name"><strong>Freehand</strong></div>
        <ul>
            <li><a href="#resources">Library</a></li>
            <li><a href="#about">About Us</a></li>
            <li><a href="https://www.buymeacoffee.com/Gabriellakwok" target="_blank" class="btn-donate">Buy Me A Coffee ‚òï</a></li>
        </ul>
    </nav>

    <header class="hero">
        <div class="hero-content">
            <h1>Skills for the actual world.</h1>
            <p>Free resources by Gabriella & Priscilla. Updated automatically.</p>
            <a href="#resources" class="btn-main">View Library</a>
        </div>
    </header>

    <section id="resources" class="container">
        <div id="dynamic-content">
            <p>Loading your resources...</p>
        </div>
    </section>

    <section id="about" class="bg-light">
        <div class="container">
            <h2>About Us</h2>
            <div class="roles-grid">
                <div class="role-box">
                    <h4>Gabriella</h4>
                    <p>Tech Lead: Systems & Infrastructure.</p>
                </div>
                <div class="role-box">
                    <h4>Priscilla</h4>
                    <p>Creative Lead: UX & Content.</p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <p>¬© 2026 Freehand | Hong Kong</p>
        <a href="admin.html" class="admin-link">Admin Dashboard</a>
    </footer>

    <script>
        async function loadResources() {
            const user = "Gabriellakwok";
            const repo = "institution-2";
            const container = document.getElementById('dynamic-content');

            try {
                const response = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/`);
                const files = await response.json();
                container.innerHTML = '';

                const categories = {};

                files.forEach(file => {
                    // Check for PDF, JPG, PNG, MP4, or ZIP
                    const isResource = /\.(pdf|jpg|jpeg|png|gif|mp4|zip)$/i.test(file.name);
                    
                    if (isResource && file.name.includes('-')) {
                        let [cat, ...rest] = file.name.split('-');
                        let title = rest.join(' ').split('.')[0];
                        
                        if (!categories[cat]) categories[cat] = [];
                        categories[cat].push({ title, url: file.download_url, name: file.name });
                    }
                });

                for (const [catName, items] of Object.entries(categories)) {
                    const section = document.createElement('div');
                    section.className = 'category-block';
                    
                    let html = `<h2 class="cat-title">${catName}</h2><div class="grid">`;
                    
                    items.forEach(item => {
                        let icon = "üìÑ";
                        if (item.name.match(/\.(jpg|jpeg|png|gif)$/i)) icon = "üñºÔ∏è";
                        if (item.name.endsWith('.mp4')) icon = "üé¨";

                        html += `
                            <div class="card">
                                <div class="card-icon">${icon}</div>
                                <h3>${item.title}</h3>
                                <a href="${item.url}" target="_blank" class="btn-text">View / Download ‚Üí</a>
                            </div>
                        `;
                    });

                    html += `</div>`;
                    section.innerHTML = html;
                    container.appendChild(section);
                }

                if (container.innerHTML === '') {
                    container.innerHTML = '<p>No categorized files found. Upload files named "Category-Name.jpg" to see them here!</p>';
                }
            } catch (e) {
                container.innerHTML = '<p>Connection Error. Please refresh.</p>';
            }
        }
        loadResources();
    </script>
</body>
</html>
