<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freehand | Skills for the Real World</title>
    <link rel="stylesheet" href="style.css?v=1.2">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>

    <nav>
        <div class="brand-name"><strong>Freehand</strong></div>
        <ul>
            <li><a href="#resources">Library</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="https://www.buymeacoffee.com/Gabriellakwok" target="_blank" class="btn-donate">Buy Me A Coffee â˜•</a></li>
        </ul>
    </nav>

    <header class="hero">
        <div class="hero-content">
            <h1>Skills for the actual world.</h1>
            <p>Resources by Gabriella & Priscilla. Organized by category.</p>
            <a href="#resources" class="btn-main">Explore Library</a>
        </div>
    </header>

    <section id="resources" class="container">
        <div id="category-wrapper">
            <p>Scanning for categories and files...</p>
        </div>
    </section>

    <section id="about" class="bg-light">
        <div class="container">
            <h2>About Freehand</h2>
            <div class="roles-grid">
                <div class="role-box">
                    <h4>Gabriella</h4>
                    <p>Tech Lead: Systems and scaling.</p>
                </div>
                <div class="role-box">
                    <h4>Priscilla</h4>
                    <p>Creative Lead: Design and UX.</p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <p>Â© 2026 Freehand | Hong Kong</p>
        <a href="admin.html" class="admin-link">Admin Dashboard</a>
    </footer>

    <script>
        async function loadFiles() {
            const username = "Gabriellakwok";
            const repo = "institution-2";
            const wrapper = document.getElementById('category-wrapper');
            
            try {
                const response = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/`);
                const files = await response.json();
                wrapper.innerHTML = ''; 

                const categories = {};

                files.forEach(file => {
                    const isResource = file.name.endsWith('.pdf') || file.name.endsWith('.zip') || file.name.endsWith('.mp4');
                    
                    if (isResource) {
                        // Logic: Name file "Category_Title.pdf" (e.g. AI_Basics.pdf)
                        let [cat, ...titleParts] = file.name.split('_');
                        let title = titleParts.join(' ').split('.')[0] || cat.split('.')[0];
                        
                        if (!titleParts.length) { cat = "General"; title = file.name.split('.')[0]; }

                        if (!categories[cat]) categories[cat] = [];
                        categories[cat].push({ title, url: file.download_url, type: file.name.endsWith('.mp4') ? 'Video' : 'Doc' });
                    }
                });

                for (const [catName, fileArray] of Object.entries(categories)) {
                    const section = document.createElement('div');
                    section.className = 'category-section';
                    section.innerHTML = `
                        <h2 class="category-title">${catName}</h2>
                        <div class="grid"></div>
                    `;
                    const grid = section.querySelector('.grid');
                    
                    fileArray.forEach(f => {
                        const card = document.createElement('div');
                        card.className = 'card';
                        card.innerHTML = `
                            <div class="card-icon">${f.type === 'Video' ? 'ðŸŽ¬' : 'ðŸ“„'}</div>
                            <h3>${f.title}</h3>
                            <a href="${f.url}" target="_blank" class="btn-text">View ${f.type} â†’</a>
                        `;
                        grid.appendChild(card);
                    });
                    wrapper.appendChild(section);
                }
            } catch (error) {
                wrapper.innerHTML = '<p>Error loading resources. Try a Hard Refresh.</p>';
            }
        }
        loadFiles();
    </script>
</body>
</html>
